(window.webpackJsonp=window.webpackJsonp||[]).push([["ezplatform-admin-ui-policy-edit-js","ezplatform-admin-ui-policy-create-with-limitation-js"],{2:function(e,t,n){e.exports=n("AVXI")},AVXI:function(e,t){function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e,t,i,a,c,u){var l=this,s=t.querySelector('meta[name="CSRF-Token"]').content,p=t.querySelector('meta[name="SiteAccess"]').content,f=t.getElementById("react-udw"),d=t.querySelectorAll(".ez-pick-location-limitation-button"),y=function(e){return e.reduce((function(e,t){return e[t[t.length-1]]={uri:"/api/ezp/v2/views",method:"POST",headers:{Accept:"application/vnd.ez.api.View+json; version=1.1","Content-Type":"application/vnd.ez.api.ViewInput+json; version=1.1","X-Requested-With":"XMLHttpRequest"},content:JSON.stringify({ViewInput:{identifier:"udw-locations-by-path-string-".concat(t.join("-")),public:!1,LocationQuery:{FacetBuilders:{},SortClauses:{SectionIdentifier:"ascending"},Filter:{LocationIdCriterion:t.join(",")},limit:50,offset:0}}})},e}),{})},m=function(e,t){!function(e,t){var n=y(e),r=new Request("/api/ezp/v2/bulk",{method:"POST",headers:{Accept:"application/vnd.ez.api.BulkOperationResponse+json","Content-Type":"application/vnd.ez.api.BulkOperation+json","X-Siteaccess":p,"X-CSRF-Token":s},body:JSON.stringify({bulkOperations:{operations:n}}),mode:"same-origin",credentials:"same-origin"}),o=u.trans("limitation.pick.error",{},"universal_discovery_widget");fetch(r).then(i.helpers.request.getJsonFromResponse).then(t).catch((function(){return i.helpers.notification.showErrorNotification(o)}))}(t.map(v),(function(t){var n=t.BulkOperationResponse.operations;Object.entries(n).forEach((function(t){var n=o(t,2),r=n[0],i=n[1].content,a=JSON.parse(i),c=e.querySelector('[data-location-id="'.concat(r,'"]')),u=c.querySelector(".ez-tag__content"),l=c.querySelector(".ez-tag__spinner");u.innerText=function(e){return e.View.Result.searchHits.searchHit.map((function(e){return e.value.Location.ContentInfo.Content.TranslatedName})).join(" / ")}(a),l.hidden=!0,u.hidden=!1}))}))},v=function(e){return function(e){return e.slice(1)}(function(e){return e.split("/").filter((function(e){return e}))}(e.pathString))},w=function(e,n){var r=n.dataset.locationId;!function(e,n){var r=t.querySelector(e),o=r.value.split(",").filter((function(e){return e!==n}));r.value=o.join(",")}(e.dataset.locationInputSelector,r),n.remove()},S=function(e,t){t.querySelector(".ez-tag__remove-btn").addEventListener("click",(function(){return w(e,t)}),!1)},b=function(){return c.unmountComponentAtNode(f)},h=function(e,n){n.length&&(function(e,n){var r=t.querySelector(e.dataset.locationInputSelector),o=n.map((function(e){return e.id})).join(",");r.value=o}(e,n),function(e,n){var r=t.querySelector(e.dataset.selectedLocationListSelector),o=e.dataset.valueTemplate,i=t.createDocumentFragment();n.forEach((function(n){var r=n.id,a=t.createElement("ul"),c=o.replace("{{ location_id }}",r);a.insertAdjacentHTML("beforeend",c);var u=a.querySelector("li"),l=u.querySelector(".ez-tag");S(e,l),i.append(u)})),r.innerHTML="",r.append(i),m(r,n)}(e,n)),b()},g=function(e){e.preventDefault();var o=e.currentTarget,s=t.querySelector(o.dataset.locationInputSelector).value.split(",").filter((function(e){return!!e})).map((function(e){return parseInt(e,10)})),p=JSON.parse(e.currentTarget.dataset.udwConfig),d=u.trans("subtree_limitation.title",{},"universal_discovery_widget");c.render(a.createElement(i.modules.UniversalDiscovery,function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({onConfirm:h.bind(l,e.target),onCancel:b,title:d,multiple:!0,selectedLocations:s},p)),f)};d.forEach((function(e){t.querySelector(e.dataset.selectedLocationListSelector).querySelectorAll(".ez-tag").forEach(S.bind(null,e)),e.addEventListener("click",g,!1)})),t.querySelectorAll(".ez-update-policy__action-wrapper").forEach((function(e){var t=e.querySelector(".ez-update-policy__source-input");new i.core.CustomDropdown({container:e,sourceInput:t,itemsContainer:e.querySelector(".ez-custom-dropdown__items")}).init()}))}(window,window.document,window.eZ,window.React,window.ReactDOM,window.Translator)}},[[2,"runtime"]]]);